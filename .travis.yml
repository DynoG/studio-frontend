language: node_js
node_js:
  - 8.9.4

branches:
  only:
    - master
    - /v\d+\.\d+\.d+$/

cache:
  directories:
    - "node_modules"

stages:
  - PR checks âœ…
  - name: Ship It ðŸš¢
    if: env(TRAVIS_BRANCH) = master
jobs:
  include:
    - stage: PR checks âœ…
      env:
        - NAME=Unit Tests
      script: npm run test
      after_script:
        - codecov
    - stage: PR checks âœ…
      env:
        - NAME=Validation Checks
      script: ./.travis/validate_changes_for_merge.sh
    - stage: Ship It ðŸš¢
      env:
        - NAME=Publish
      script: rm -rf dist/ && rm -rf node_modules/ && npm install && npm run build && semantic-release

notifications:
  webhooks: https://www.travisbuddy.com/
